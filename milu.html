<!DOCTYPE html>
<html>
	<head>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=10,user-scalable=yes" />
    	<meta charset="utf-8" />
		<script type="text/javascript" src="js/jquery-3.1.1.min.js" ></script>
		<script type="text/javascript" src="js/public.js" ></script>
		<!--<link rel="stylesheet" href="css/style.css" />-->
		<script type="text/javascript" src="js/color.js" ></script>
		<title>魔法咪路咪路的故事</title>
	</head>
	<body>
		<div class="page">
			<div class="parent">
				<div id="svg_box">
					<svg viewbox="0 0 900 1556" width="100%" height="100%">
						<!--<path d="M50 237
							C60 131 224 149 212 292
							C172 388 32 345 50 236"
							fill="#faf440"  class="click" stroke="#000" stroke-width="1" dete-value="糖"/>
						<path d="M48 246
							C99 292 177 217 169 186
							L180 190
							C164 269 79 280 51 257
							L48 246"
							fill="#5785bb" class="click" stroke="none" stroke-width="1" dete-value="条纹1"/>
						<path d="M72, 308
							C126, 336, 198, 287, 206, 238
							L211, 255
							C195, 301, 138, 345, 75, 316
							L72 308" 
							fill="#ea4dae" class="click" stroke="none" stroke-width="1" data-value="条纹2"/>
						<path d="M155 344
							L188 324
							L223 409
							C232 421 203 435 200 427
							L155 344"
							fill="#f14db9" class="click" stroke="#000" stroke-width="1" dete-value="棒子"/>-->
<!--咪路咪路-->
						<path d="M343, 134
							C321, 111, 429, 104, 415, 133
							C405, 131, 339, 133, 343, 136"
							fill="#c5b8d4"  class="click" stroke="#000" stroke-width="1" dete-value="帽子"/>
						<path d="M240, 232
							C245, 93, 512, 99, 514, 237
							C387, 190, 270, 221, 239, 232"
							fill="#c5b8d4"  class="click" stroke="#000" stroke-width="1" dete-value="帽子"/>
						<path d="M354, 117
							C359, 68, 329, 70, 325, 84
							C306, 92, 306, 75, 298, 84
							C274, 96, 275, 71, 258, 101
							C209, 101, 245, 17, 300, 25
							C313, 25, 354, 22, 374, 57
							C395, 3, 527, 5, 523, 84
							C528, 90, 518, 107, 504, 90
							C495, 102, 483, 96, 482, 85
							C466, 101, 450, 89, 446, 83
							C421, 100, 402, 54, 390, 114"
							fill="#234e93"  class="click" stroke="#000" stroke-width="1" dete-value="皇冠"/>
						<path d="M225, 131
							C247, 125, 223, 92, 214, 119
							C208, 128, 224, 135, 230, 130" 
							fill="#234e93" class="click" stroke="none" stroke-width="1" data-value="皇冠点点"/>
						<path d="M566, 106
							C563, 81, 533, 95, 548, 112
							C554, 124, 570, 114, 566, 106" 
							fill="#234e93" class="click" stroke="none" stroke-width="1" data-value="皇冠点点"/>
						<path d="M237, 279
							C223, 280, 223, 311, 245, 311
							C245, 311, 263, 262, 237, 279"
							fill="#f7d2bf" class="click" stroke="#000" stroke-width='1' data-value="左耳" />
						<path d="M493, 275
							C517, 255, 532, 306, 506, 309
							C503, 293, 493, 291, 492, 275"
							fill="#f7d2bf" class="click" stroke="#000" stroke-width='1' data-value="右耳" />
							<path d="M327, 510
							C342, 539, 341, 563, 347, 510"
							fill="#1e2854" class="click" stroke="#000" stroke-width='1' date-value="左脚" />
						<path d="M411, 511
							C411, 538, 409, 553, 429, 504"
							fill="#1e2854" class="click" stroke="#000" stroke-width='1' date-value="右脚" />
						<path d="M305, 434
							C301, 456, 281, 533, 368, 505
							C418, 520, 461, 516, 441, 441
							C461, 459, 497, 444, 463, 391
							C333, 372, 315, 425, 304, 433"
							fill="#b5dbee" class="click" stroke="#000" stroke-width='1' date-value="身体" />
						<path d="M463, 449
							C462, 467, 496, 463, 476, 440"
							fill="#f6d2bf" class="click" stroke="#000" stroke-width='1' date-value="右拳拳" />
						<path d="M455, 364
							C474, 358, 505, 399, 460, 392
							C450, 408, 430, 388, 419, 398
							C379, 434, 375, 381, 343, 413
							C309, 419, 329, 389, 283, 382
							C273, 379, 286, 353, 300, 365"
							fill="#ef8c8e" class="click" stroke="#000" stroke-width='1' date-value="衣领" />
						<path d="M254, 270
							C248, 279, 241, 315, 247, 328
							C314, 402, 475, 389, 509, 314
							C507, 283, 482, 281, 484, 262
							C486, 252, 318, 220, 253, 265"
							fill="#f7d2bf" class="click" stroke="#000" stroke-width='1' data-value="脸" />
						<path d="M253, 327
							C245, 272, 311, 285, 308, 314
							C286, 360, 256, 336, 253, 327"
							fill="#2473a3" class="click" stroke="none" stroke-width='1' data-value="左腮红" />
						<path d="M260, 315        
							C253, 299, 286, 302, 273, 322        
							C265, 335, 247, 314, 262, 310"
							fill="#fff" class="click" stroke="none" stroke-width='1' data-value="左腮红点" />
						<path d="M494, 327
							C472, 352, 424, 343, 452, 298
							C472, 280, 515, 282, 494, 327"
							fill="#2473a3" class="click" stroke="none" stroke-width='1' data-value="右腮红" />
						<path d="M455, 326   
							C444, 318, 458, 298, 467, 314      
							C476, 321, 467, 334, 456, 327"
							fill="#fff" class="click" stroke="none" stroke-width='1' data-value="右腮红点" />
						<path d="M330, 286
							C316, 280, 339, 235, 361, 275
							C361, 300, 334, 301, 330, 286"
							fill="#000" class="click" stroke="none" stroke-width='1' date-value="左眼" />
						<path d="M336, 268
							C352, 258, 346, 289, 333, 279
							C327, 275, 336, 269, 336, 268"
							fill="#fff" class="click" stroke="none" stroke-width='1' date-value="左眼白" />
						<path d="M388, 273
							C386, 250, 426, 251, 419, 280
							C419, 298, 383, 299, 388, 273"
							fill="#000" class="click" stroke="none" stroke-width='1' date-value="右眼" />
						<path d="M399, 280
							C384, 274, 396, 252, 404, 271
							C404, 271, 410, 280, 399, 280"
							fill="#fff" class="click" stroke="none" stroke-width='1' date-value="右眼白" />
						<path d="M215, 236
							C387, 195, 428, 211, 535, 241
							C549, 266, 524, 281, 515, 276
							C485, 272, 483, 252, 466, 258
							C417, 284, 411, 242, 396, 250
							C347, 280, 335, 251, 320, 254
							C290, 278, 279, 275, 263, 265
							C251, 292, 198, 280, 217, 237"
							fill="#204f94" class="click" stroke="#000" stroke-width='1' date-value="帽檐" />
						<path d="M364, 331
							C357, 324, 372, 332, 376, 329
							C379, 362, 358, 340, 364, 327"
							fill="#ef8c8e" class="click" stroke="#000" stroke-width='1' date-value="嘴" />
						
						<path d="M308, 432
							C278, 434, 260, 370, 319, 368
							C355, 354, 353, 440, 305, 433"
							fill="#b5dbee" class="click" stroke="#000" stroke-width='1' date-value="左手" />
						<path d="M320, 372
							C321, 344, 351, 358, 342, 378
							C342, 378, 320, 382, 320, 372"
							fill="#f6d2bf" class="click" stroke="#000" stroke-width='1' date-value="左拳拳" />
						<path d="M375, 404
							C396, 450, 356, 444, 374, 403"
							fill="#296b9d" class="click" stroke="#000" stroke-width='1' date-value="水滴1"/>
						<path d="M376, 453
							C401, 499, 355, 494, 375, 453"
							fill="#296b9d" class="click" stroke="#000" stroke-width='1' date-value="水滴1"/>
						
<!-- 章鱼  -->
						<path d="M292, 886
							C293, 886, 293, 920, 286, 920
							C304, 962, 379, 966, 404, 955
							C407, 901, 388, 895, 291, 882"
							fill="#cc5551" class="click" stroke="#000" stroke-width='1' date-value="章鱼衣"/>
						<path d="M279, 970
							C274, 1011, 233, 1012, 212, 997
							C204, 1038, 298, 1085, 331, 983"
							fill="#eab660" class="click" stroke="#000" stroke-width='1' date-value="章鱼须左2"/>
						<path d="M468, 961
							C474, 974, 508, 991, 529, 958
							C562, 993, 467, 1078, 421, 977"
							fill="#eab660" class="click" stroke="#000" stroke-width='1' date-value="章鱼须右2"/>
						<path d="M314, 990
							C321, 1038, 293, 1090, 240, 1073
							C268, 1127, 392, 1120, 377, 989"
							fill="#eab660" class="click" stroke="#000" stroke-width='1' date-value="章鱼须左3"/>
						<path d="M445, 975
							C453, 1050, 522, 1049, 553, 1040
							C537, 1108, 370, 1103, 379, 992"
							fill="#eab660" class="click" stroke="#000" stroke-width='1' date-value="章鱼须右3"/>
						<path d="M292, 901
							C272, 956, 382, 985, 456, 930
							C508, 938, 447, 991, 378, 998
							C310, 1005, 216, 953, 290, 897"
							fill="#fff" class="click" stroke="#000" stroke-width='1' date-value="章鱼圈"/>
						<path d="M223, 786
							C165, 758, 209, 688, 240, 705"
							fill="#739622" class="click" stroke="#000" stroke-width='1' date-value="左耳机"/>
						<path d="M223, 786
							C191, 758, 218, 709, 240, 705"
							fill="#739622" class="click" stroke="#000" stroke-width='1' date-value="左耳机1"/>
						
						<path d="M240, 705
							C293, 595, 560, 597, 566, 795
							C563, 992, 132, 929, 240, 703"
							fill="#eab660" class="click" stroke="#000" stroke-width='1' date-value="章鱼脑袋"/>
						<path d="M240, 703
							C366, 544, 578, 667, 560, 795
							L547, 793
							C550, 625, 310, 606, 241, 703"
							fill="#8d969c" class="click" stroke="#000" stroke-width='1' date-value="耳机"/>
						<path d="M560, 793
							C605, 813, 581, 899, 526, 879
							C500, 881, 498, 781, 558, 795"
							fill="#739622" class="click" stroke="#000" stroke-width='1' date-value="右耳机"/>
						<path d="M565, 795
							C592, 813, 590, 872, 545, 882
							C523, 848, 543, 800, 562, 796"
							fill="#739622" class="click" stroke="#000" stroke-width='1' date-value="右耳机1"/>
						<path d="M238, 840
							C268, 835, 232, 808, 221, 821
							C155, 874, 250, 959, 302, 888"
							fill="#eab660" class="click" stroke="#000" stroke-width='1' date-value="章鱼须左"/>
						<path d="M451, 915
							C440, 893, 435, 909, 436, 885
							C456, 868, 415, 838, 397, 882
							C357, 976, 484, 1002, 473, 905
							C467, 891, 440, 889, 444, 906"
							fill="#eab660" class="click" stroke="#000" stroke-width='1' date-value="章鱼须右"/>
						<path d="M324, 909
							L307, 908
							L316, 932
							L305, 962
							L334, 961
							L365, 981
							L361, 944
							L385, 929
							L359, 917
							L344, 893
							L324, 909"
							fill="#e1c74e" class="click" stroke="#000" stroke-width='1' date-value="大星星"/>
						<path d="M300, 752
							C256, 762, 295, 784, 299, 835
							C298, 863, 291, 915, 358, 910
							C432, 895, 415, 780, 400, 769
							C382, 764, 362, 771, 346, 771
							C311, 765, 313, 742, 290, 755"
							fill="#e88b6a" class="click" stroke="#000" stroke-width='1' date-value="章鱼唇"/>
						<path d="M309, 790
							C325, 826, 319, 868, 327, 877
							C354, 901, 396, 871, 380, 795
							C358, 818, 329, 804, 309, 791"
							fill="#e9b562" class="click" stroke="#000" stroke-width='1' date-value="章鱼舌"/>
						<path d="M306, 706
							C275, 709, 280, 738, 298, 740
							C320, 738, 323, 708, 301, 707"
							fill="#000" class="click" stroke="none" stroke-width='1' date-value="左眼"/>
						<path d="M297, 725
							C315, 734, 313, 704, 305, 709
							C297, 707, 284, 716, 296, 725"
							fill="#fff" class="click" stroke="none" stroke-width='1' date-value="左眼白"/>
						<path d="M430, 744
							C418, 737, 393, 779, 432, 782
							C460, 781, 452, 740, 430, 744"
							fill="#000" class="click" stroke="none" stroke-width='1' date-value="右眼"/>
						<path d="M428, 745
							C407, 750, 417, 767, 428, 765
							C444, 770, 444, 743, 427, 746"
							fill="#fff" class="click" stroke="none" stroke-width='1' date-value="右眼白"/>
						<path d="M268, 756
							C287, 742, 265, 718, 250, 738
							C238, 754, 264, 765, 268, 756"
							fill="#fff" class="click" stroke="none" stroke-width='1' date-value="左腮红"/>
						<path d="M440, 795
							C452, 778, 474, 794, 463, 815
							C454, 821, 435, 813, 440, 795"
							fill="#fff" class="click" stroke="none" stroke-width='1' date-value="右腮红"/>
					</svg>
				</div>
			</div>
			<div class="info_color"></div>
			<button id="reduction">还原</button>
			<button id="revoke">撤销</button>
			<div class="color play" id="color_ban" style="display:none">
				<ul id="colorr"></ul>
				<div class="clearfix color_btn">
					<div class="flt col-xs-6"><button class="confirm">确认</button></div>
					<div class="frt col-xs-6"><button class="cancel">取消</button></div>
				</div>
			</div>
		</div>
	</body>
</html>
<style type="text/css">
.page{position:absolute;width:100%;height:100%;left:0;bottom:0;top:0;right:0;z-index:0;overflow:hidden;}
.parent{background:#ccc;width:27rem;height:35rem;position:relative;margin:0 auto;}
.svg_box{width:27rem;height:35rem;margin:0 auto;background:#ccc;}
.svg_box svg{position:relative;z-index:2;}
.info_color{width:7rem;height:3rem;margin:2rem auto;background:#08c;}
button{width: 25%;display: block;height: 3rem;border-radius: 0.3rem;font-size: 1.3rem;position: absolute;margin-top: -1.5rem;bottom: 10%;}
#reduction{left:2rem;}
#revoke{right:2rem;}
.color{width:100%;height:100%;position:fixed;z-index:998;background:rgba(0,0,0,0.5);left:0;top:0;}
.color ul{width:29rem;margin:auto;overflow-y:auto;height:80%;-webkit-overflow-scrolling: touch;-webkit-transform: translate3d(0,0,0);}
.color ul li{width:3rem;height:3rem;list-style:none;float:left;margin:0.5rem 1rem;border:0.1rem solid;box-sizing:border-box;}
.color_btn{position:absolute;bottom:0;left:0;right:0;height:15%;background:#f0f0f0;}
.color_btn div{position:relative;height:100%;}
.color_btn div button{width:50%;display:block;height:3rem;border-radius:0.3rem;font-size:1.3rem;position:absolute;left:25%;margin-top:-1.5rem;top:50%;}
.color_btn div button.confirm{background:#08c;color:#fff;}
.color_btn div button.cancel{background:#999;color:#08c}
.color ul li.on{box-shadow:0 0 5px 2px #fff;}
.play.color ul{-webkit-animation:color_ul 1s ease 1;}
@-webkit-keyframes color_ul{
	0%{-webkit-transform:translateY(-100%);opacity:0;}
	100%{-webkit-transform:translateY(0);opacity:1}
}
.play .color_btn{-webkit-animation:color_btn 1s ease 1;}
@-webkit-keyframes color_btn{
	0%{-webkit-transform:translateY(100%);opacity:0;}
	100%{-webkit-transform:translateY(0);opacity:1}
}
.clearfix:before, .clearfix:after {display: table;content: '';}
.clearfix:after {clear: both;}
.flt {float: left;}
.frt {float: right;}
.col-xs-6{width:50%;}
.confirm{background:#08c;color:#fff;}
.cancel{background:#999;color:#08c}
</style>
<script>
	/*初始化*/
	var oInfoFillColor = [];
	var dataValue = 0;
	for(var onum = 0;onum<$("#svg_box").find('path').length;onum++){
		$("#svg_box").find('path').eq(onum).attr('id','id'+onum);
	};
	/*先存源码*/
	var io = [];
	var iostroke = [];
	for(var p = 0;p<$("#svg_box").find('path').length;p++){
		var oReduction = $("#svg_box").find('path').eq(p).attr('fill');
		var iostroker = $("#svg_box").find('path').eq(p).attr('stroke');
		io.push(oReduction);
		iostroke.push(iostroker);
	};
	/*还原*/
	$("#reduction").click(function(){
		 for(var p=0;p<io.length;p++){
		 	$("#svg_box").find('path').eq(p).attr('fill',io[p]);
		 	$("#svg_box").find('path').eq(p).attr('stroke',iostroke[p]);
		 };
		for(var oMx=1;oMx<dataValue;oMx++){
			var thisId = $("[data"+oMx+"]").attr("id");
			$('#'+thisId).removeAttr("data"+oMx);
		}
	});
	
	/*撤销*/
	$("#revoke").click(function(){
		fillMax();
		$("#revoke").attr("disabled","disabled");
		setTimeout(function(){
			$("#revoke").removeAttr("disabled");
		},500)
	});
	function fillMax(){
		var oMaxAll = [];
		for(var oMx=0; oMx<dataValue; oMx++){
			oMaxAll.push(oMx);
		}
		var oMax = parseInt(getMax(oMaxAll))+1;
		for(var i = 0; i < oInfoFillColor.length; i++){
			$("[data"+oMax+"]").attr('fill',oInfoFillColor[i]);
		};
		var thisId = $("[data"+oMax+"]").attr("id");
		$('#'+thisId).removeAttr("data"+oMax);
		oInfoFillColor.pop();
		dataValue--;
	}


	function getMax(arr){  
        var max = arr[0];
        for (var x=1; x<arr.length; x++) {  
            if (arr[x]>max) {  
                max = arr[x];  
            }  
        }  
        return max;  
    }  

	for(var i=0;i<color.length;i++){
		var oLi = document.createElement("li");
		oLi.style.background = color[i];
		var oUl = document.getElementById("colorr");
		oUl.insertBefore(oLi,oUl.childNodes[0]);
		
	};
	$(function(){
		var getColor = $('.info_color').css("background-color");
		$(".color li").eq(0).addClass("on");
		
		oBgColor = $(".color").css("background-color");
		$(".color li").css("border-color",oBgColor);
		
		
		$("#colorr li").click(function(){
			for(var i=0;i<$("#colorr li").length;i++){
				$("#colorr li").removeClass("on");
			};
			$(this).addClass("on");
		});
		
		$("#colorr").ontouchmove = function(even){
			event.stopPropagation();
		};
		
		$('.confirm').click(function(){		//颜色板确认
			getColor = $("#colorr li.on").css("background-color");
			closeColor();
			$('.info_color').css("background",getColor);
			return getColor;
		});
		$('.cancel').click(function(){		//颜色板取消
			closeColor();
		});
		
		$('.info_color').click(function(){	//颜色选择
			openColor();
		});
		
		function openColor(){
			$("#color_ban").show();
			$("#color_ban").removeClass("close").addClass("play");
			
		};
		
		function closeColor(){
			$("#color_ban").removeClass("play").addClass("close");
			$(".color").fadeOut(950);
			setTimeout(function(){
				$("#color_ban").hide();
			},950);
		};
		var v = 0;
		$('.click').click(function(){			//点击赋色
			var oInfoFill = $(this).attr("fill");
			oInfoFillColor.push(oInfoFill);
			dataValue++;
			$(this).attr("data"+dataValue,true);
			$(this).attr("fill",getColor);
		});
		
	});
</script>
